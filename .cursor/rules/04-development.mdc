---
alwaysApply: true
---
# 开发规则

## 日志服务优先

每个新组件必须首先实现日志系统。

## 调试模式

开发阶段默认启用调试模式和日志文件写入。

## 日志自动清理

- 保留最近10个日志文件
- 单个文件<10MB
- 总大小<50MB

## 构建和部署规则（强制）

### 使用预置脚本（强制）

AI必须使用项目中已有的脚本，不得手动查找工具路径。

**手机端部署：**
```bash
cd server && ./scripts/deploy_android.sh
```

**Mac客户端部署：**
```bash
cd client && ./scripts/deploy_mac.sh
```

**Windows客户端部署：**
```bash
cd client && scripts\deploy_windows.bat
```

### 禁止行为

- ❌ 手动查找flutter路径
- ❌ 手动执行flutter命令
- ❌ 不使用预置脚本
- ✅ 必须使用scripts目录中的部署脚本

## 实施状态

### 手机端（Server）
- [x] LoggerService
- [x] 独立日志文件
- [x] HTTP日志
- [x] 相机日志
- [x] 错误堆栈跟踪
- [x] adb可获取

### 客户端（Client）
- [x] ClientLoggerService
- [x] 独立日志文件
- [x] API调用日志
- [x] 错误堆栈跟踪
- [x] 文件系统可访问

### 日志收集
- [x] collect_all_logs.sh脚本
- [x] 自动收集手机端日志
- [x] 自动收集客户端日志
