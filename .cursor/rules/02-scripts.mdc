---
alwaysApply: true
---
# 脚本规则 - 最高优先级

## 核心约束（强制）

1. **所有调试操作必须使用项目中已有的脚本**，禁止手动执行命令
2. 如果脚本无法完成工作，**必须修改脚本**使其正常工作
3. AI必须主动执行脚本，不要求用户操作

## 部署脚本

### 手机端部署（强制使用）

**路径：** `server/scripts/deploy.sh` 或 `server/scripts/deploy_android.sh`（向后兼容）

**使用方式：**
```bash
cd server && ./scripts/deploy.sh --debug
# 或使用向后兼容脚本
cd server && ./scripts/deploy_android.sh
```

**功能：**
- 自动查找Flutter
- 构建APK
- 检查设备连接
- 安装APK
- 可选启动应用

### Mac客户端部署（强制使用）

**路径：** `client/scripts/deploy.sh` 或 `client/scripts/deploy_mac.sh`（向后兼容）

**使用方式：**
```bash
cd client && ./scripts/deploy.sh --debug --macos
# 或使用向后兼容脚本
cd client && ./scripts/deploy_mac.sh
```

**功能：**
- 自动查找Flutter
- 构建macOS应用
- 可选启动应用

### Windows客户端部署（强制使用）

**路径：** `client/scripts/deploy.sh` 或 `client/scripts/deploy_windows.bat`（向后兼容）

**使用方式：**
```bash
cd client && bash scripts/deploy.sh --debug --windows
# 或使用向后兼容脚本（需要 Git Bash 或 WSL）
cd client && scripts\deploy_windows.bat
```

## 禁止行为

- ❌ 手动查找flutter路径
- ❌ 手动执行flutter命令（build、run、install等）
- ❌ 手动使用adb命令收集日志
- ❌ 手动访问日志文件路径
- ❌ 不使用预置脚本进行任何调试操作
- ❌ 要求用户手动执行命令
- ❌ 绕过脚本直接操作
- ❌ 脚本失败后不使用脚本，改为手动执行命令
- ❌ 要求用户手动修复脚本
- ❌ 跳过脚本直接操作
- ❌ 不修复脚本而使用临时方案

## 必须遵守

- ✅ 所有部署必须使用部署脚本
- ✅ 所有日志收集必须使用 `collect_all_logs.sh`
- ✅ 脚本出现问题必须立即修复
- ✅ 修复脚本是AI的责任，不得推给用户
- ✅ 修复后的脚本必须能够正常完成预期功能
- ✅ 修复脚本后必须验证脚本能够正常工作
- ✅ 保持脚本的健壮性和可维护性
- ✅ AI必须主动执行脚本，不要求用户操作

## 脚本维护规则（强制）

**如果预置脚本无法完成工作，必须修改脚本使其符合预期正常工作。**

### 脚本问题处理流程

1. **发现问题：** 当脚本执行失败或无法完成预期功能时
2. **分析问题：** 检查脚本错误信息，定位问题原因
3. **修复脚本：** 直接修改脚本文件，使其能够正常工作
4. **验证修复：** 重新执行脚本，确保问题已解决
5. **继续工作：** 使用修复后的脚本继续完成调试任务
