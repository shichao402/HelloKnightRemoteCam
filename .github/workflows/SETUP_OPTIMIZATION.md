# GitHub Actions Setup æ­¥éª¤è€—æ—¶åˆ†æä¸ä¼˜åŒ–

## ğŸ” ä¸ºä»€ä¹ˆ setup-java å’Œ setup-flutter å¾ˆè€—æ—¶ï¼Ÿ

### ä¸»è¦åŸå› 

#### 1. **ä¸‹è½½å’Œå®‰è£…æ—¶é—´** â±ï¸
- **setup-java**: éœ€è¦ä¸‹è½½ JDKï¼ˆé€šå¸¸ 100-200MBï¼‰
  - Temurin JDK 17: ~150MB
  - ä¸‹è½½æ—¶é—´ï¼šå–å†³äºç½‘ç»œé€Ÿåº¦ï¼ˆé€šå¸¸ 10-30 ç§’ï¼‰
  - è§£å‹å’Œå®‰è£…ï¼š5-15 ç§’
  
- **setup-flutter**: éœ€è¦ä¸‹è½½ Flutter SDKï¼ˆé€šå¸¸ 500MB-1GBï¼‰
  - Flutter SDK 3.24.0: ~800MB
  - ä¸‹è½½æ—¶é—´ï¼šå–å†³äºç½‘ç»œé€Ÿåº¦ï¼ˆé€šå¸¸ 30-60 ç§’ï¼‰
  - è§£å‹å’Œå®‰è£…ï¼š10-30 ç§’

#### 2. **ç¼“å­˜å¤„ç†æ—¶é—´** ğŸ“¦
- **setup-java çš„ Gradle ç¼“å­˜**:
  - å¦‚æœå¯ç”¨ `cache: 'gradle'`ï¼Œéœ€è¦ï¼š
    - æ¢å¤ç¼“å­˜ï¼šå¦‚æœç¼“å­˜å­˜åœ¨ï¼Œéœ€è¦ä¸‹è½½ï¼ˆå¯èƒ½ 100MB-1GBï¼‰
    - ä¿å­˜ç¼“å­˜ï¼šæ„å»ºåéœ€è¦ä¸Šä¼ ç¼“å­˜ï¼ˆå¯èƒ½å¾ˆæ…¢ï¼‰
  - **é—®é¢˜**ï¼šGradle ç¼“å­˜å¯èƒ½éå¸¸å¤§ï¼ˆ6GB+ï¼‰ï¼Œä¸Šä¼ /ä¸‹è½½è€—æ—¶å¾ˆé•¿
  
- **setup-flutter çš„ç¼“å­˜**:
  - Flutter SDK æœ¬èº«ä¸ä¼šè¢«ç¼“å­˜ï¼ˆæ¯æ¬¡éƒ½é‡æ–°ä¸‹è½½ï¼‰
  - åªæœ‰ `pub cache` å’Œ `.dart_tool` è¢«ç¼“å­˜

#### 3. **è¿è¡Œå™¨æ€§èƒ½é™åˆ¶** ğŸ–¥ï¸
- GitHub æ‰˜ç®¡è¿è¡Œå™¨æ€§èƒ½æœ‰é™ï¼š
  - CPUï¼š2 æ ¸å¿ƒ
  - ç½‘ç»œå¸¦å®½ï¼šå…±äº«å¸¦å®½ï¼Œå¯èƒ½ä¸ç¨³å®š
  - ç£ç›˜ I/Oï¼šå¯èƒ½è¾ƒæ…¢

#### 4. **é¡ºåºæ‰§è¡Œ** ğŸ”„
- è¿™äº›æ­¥éª¤å¿…é¡»é¡ºåºæ‰§è¡Œï¼š
  ```
  Checkout â†’ Setup Java â†’ Setup Flutter â†’ Build
  ```
- æ— æ³•å¹¶è¡Œï¼Œæ€»è€—æ—¶ = å„æ­¥éª¤è€—æ—¶ä¹‹å’Œ

---

## ğŸ“Š å…¸å‹è€—æ—¶åˆ†æ

### setup-java (å¯ç”¨ Gradle ç¼“å­˜)
```
ä¸‹è½½ JDK:        10-30 ç§’
å®‰è£… JDK:        5-15 ç§’
æ¢å¤ Gradle ç¼“å­˜: 20-60 ç§’ï¼ˆå¦‚æœç¼“å­˜å­˜åœ¨ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡:            35-105 ç§’
```

### setup-flutter
```
ä¸‹è½½ Flutter SDK: 30-60 ç§’
å®‰è£… Flutter SDK: 10-30 ç§’
æ¢å¤ pub cache:   5-20 ç§’ï¼ˆå¦‚æœç¼“å­˜å­˜åœ¨ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡:            45-110 ç§’
```

### æ€»è®¡
```
setup-java + setup-flutter = 80-215 ç§’ï¼ˆçº¦ 1.3-3.6 åˆ†é’Ÿï¼‰
```

---

## ğŸš€ ä¼˜åŒ–ç­–ç•¥

### 1. **ä¼˜åŒ– Gradle ç¼“å­˜** âš ï¸ é‡è¦

**å½“å‰é…ç½®ï¼š**
```yaml
- name: Setup Java
  uses: actions/setup-java@v4
  with:
    distribution: 'temurin'
    java-version: '17'
    cache: 'gradle'  # å¯ç”¨ Gradle ç¼“å­˜
```

**é—®é¢˜ï¼š**
- `cache: 'gradle'` ä¼šç¼“å­˜æ•´ä¸ª `.gradle` ç›®å½•ï¼Œå¯èƒ½éå¸¸å¤§ï¼ˆ6GB+ï¼‰
- ä¸Šä¼ /ä¸‹è½½å¤§ç¼“å­˜éå¸¸è€—æ—¶

**ä¼˜åŒ–æ–¹æ¡ˆ Aï¼šåªç¼“å­˜å¿…è¦çš„ç›®å½•**
```yaml
- name: Setup Java
  uses: actions/setup-java@v4
  with:
    distribution: 'temurin'
    java-version: '17'
    # ä¸å¯ç”¨è‡ªåŠ¨ç¼“å­˜ï¼Œæ‰‹åŠ¨æ§åˆ¶

- name: Cache Gradle dependencies
  uses: actions/cache@v4
  with:
    path: |
      ~/.gradle/caches/modules-2
      ~/.gradle/caches/modules-2/files-2.1
      ~/.gradle/caches/jars-3
    key: gradle-${{ runner.os }}-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
    restore-keys: |
      gradle-${{ runner.os }}-
```

**ä¼˜åŒ–æ–¹æ¡ˆ Bï¼šä½¿ç”¨æ›´ç²¾ç¡®çš„ç¼“å­˜é”®**
```yaml
- name: Setup Java
  uses: actions/setup-java@v4
  with:
    distribution: 'temurin'
    java-version: '17'
    cache: 'gradle'
    cache-dependency-path: 'server/**/*.gradle*'  # åªç¼“å­˜ server é¡¹ç›®çš„ä¾èµ–
```

**æƒè¡¡ï¼š**
- âœ… æ–¹æ¡ˆ Aï¼šæ›´ç²¾ç¡®æ§åˆ¶ï¼Œä½†éœ€è¦æ‰‹åŠ¨ç®¡ç†
- âœ… æ–¹æ¡ˆ Bï¼šç®€å•ï¼Œä½†å¯èƒ½ä»ç„¶ç¼“å­˜è¿‡å¤šå†…å®¹
- **å»ºè®®**ï¼šå¦‚æœ Gradle ç¼“å­˜ä¸Šä¼ æ—¶é—´ > 2 åˆ†é’Ÿï¼Œä½¿ç”¨æ–¹æ¡ˆ A

### 2. **ä¼˜åŒ– Flutter SDK ä¸‹è½½** âš ï¸ é‡è¦

**å½“å‰é…ç½®ï¼š**
```yaml
- name: Setup Flutter
  uses: subosito/flutter-action@v2
  with:
    flutter-version: ${{ env.FLUTTER_VERSION }}
    channel: 'stable'
    cache: false  # ç¦ç”¨å†…ç½®ç¼“å­˜
```

**é—®é¢˜ï¼š**
- Flutter SDK æ¯æ¬¡éƒ½è¦é‡æ–°ä¸‹è½½ï¼ˆ~800MBï¼‰
- æ— æ³•ç¼“å­˜ SDK æœ¬èº«ï¼ˆå› ä¸ºå®ƒåœ¨ä¸´æ—¶ç›®å½•ï¼‰

**ä¼˜åŒ–æ–¹æ¡ˆï¼šä½¿ç”¨ Flutter ç¼“å­˜**
```yaml
- name: Cache Flutter SDK
  uses: actions/cache@v4
  id: flutter_cache
  with:
    path: |
      ${{ env.FLUTTER_HOME }}
      ~/.pub-cache
    key: flutter-sdk-${{ runner.os }}-${{ env.FLUTTER_VERSION }}
    restore-keys: |
      flutter-sdk-${{ runner.os }}-

- name: Setup Flutter
  uses: subosito/flutter-action@v2
  if: steps.flutter_cache.outputs.cache-hit != 'true'
  with:
    flutter-version: ${{ env.FLUTTER_VERSION }}
    channel: 'stable'
    cache: false
```

**æ³¨æ„ï¼š**
- Flutter SDK è·¯å¾„å¯èƒ½å› å¹³å°è€Œå¼‚
- éœ€è¦æ£€æŸ¥ `subosito/flutter-action` æ˜¯å¦æ”¯æŒç¼“å­˜ SDK

**æ›´å®é™…çš„æ–¹æ¡ˆï¼š**
- Flutter SDK ä¸‹è½½æ˜¯ä¸å¯é¿å…çš„
- é‡ç‚¹ä¼˜åŒ– pub cache å’Œ .dart_tool çš„ç¼“å­˜ï¼ˆå·²å®ç°ï¼‰

### 3. **å¹¶è¡Œæ‰§è¡Œä¼˜åŒ–** âœ… å·²å®ç°

**å½“å‰çŠ¶æ€ï¼š**
- âœ… macOSã€Windowsã€Android æ„å»ºå¹¶è¡Œæ‰§è¡Œ
- âœ… æ¯ä¸ªå¹³å°ç‹¬ç«‹è¿è¡Œï¼Œäº’ä¸å½±å“

**è¿›ä¸€æ­¥ä¼˜åŒ–ï¼š**
- å¦‚æœå¯èƒ½ï¼Œå°†ç‰ˆæœ¬æå–æ­¥éª¤æå‰ï¼Œä¸å…¶ä»–æ­¥éª¤å¹¶è¡Œ

### 4. **ä½¿ç”¨è‡ªæ‰˜ç®¡è¿è¡Œå™¨** ğŸ’¡ å¯é€‰

**ä¼˜åŠ¿ï¼š**
- æ›´é«˜çš„ CPU/å†…å­˜æ€§èƒ½
- æ›´å¿«çš„ç½‘ç»œå¸¦å®½
- å¯ä»¥é¢„è£… JDK å’Œ Flutter SDK

**æƒè¡¡ï¼š**
- âœ… æ˜¾è‘—å‡å°‘ setup æ—¶é—´ï¼ˆå¯èƒ½å‡å°‘ 50-70%ï¼‰
- âŒ éœ€è¦ç»´æŠ¤è¿è¡Œå™¨
- âŒ éœ€è¦å®‰å…¨é…ç½®

**é€‚ç”¨åœºæ™¯ï¼š**
- å¦‚æœæ„å»ºæ—¶é—´ > 30 åˆ†é’Ÿ
- å¦‚æœé¢‘ç¹æ„å»ºï¼ˆæ¯å¤© > 10 æ¬¡ï¼‰
- å¦‚æœæœ‰é¢„ç®—å’Œè¿ç»´èƒ½åŠ›

### 5. **å‡å°‘ä¸å¿…è¦çš„æ­¥éª¤** âœ… å·²ä¼˜åŒ–

**å½“å‰çŠ¶æ€ï¼š**
- âœ… ä½¿ç”¨ `fetch-depth: 1` å‡å°‘ checkout æ—¶é—´
- âœ… ç¼“å­˜ Python ä¾èµ–
- âœ… ç¼“å­˜ Flutter ä¾èµ–

**å¯é€‰çš„è¿›ä¸€æ­¥ä¼˜åŒ–ï¼š**
```yaml
# åªåœ¨éœ€è¦æ—¶å®‰è£… Python ä¾èµ–
- name: Setup Python
  uses: actions/setup-python@v5
  with:
    python-version: '3.x'
    cache: 'pip'  # è‡ªåŠ¨ç¼“å­˜ pip ä¾èµ–
```

---

## ğŸ“ˆ é¢„æœŸä¼˜åŒ–æ•ˆæœ

### å½“å‰è€—æ—¶ï¼ˆä¼°ç®—ï¼‰
```
setup-java:     35-105 ç§’
setup-flutter:  45-110 ç§’
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡:           80-215 ç§’ï¼ˆ1.3-3.6 åˆ†é’Ÿï¼‰
```

### ä¼˜åŒ–åè€—æ—¶ï¼ˆä¼°ç®—ï¼‰

#### æ–¹æ¡ˆ 1ï¼šä¼˜åŒ– Gradle ç¼“å­˜
```
setup-java:     25-60 ç§’ï¼ˆå‡å°‘ 30-45 ç§’ï¼‰
setup-flutter:  45-110 ç§’ï¼ˆä¸å˜ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡:           70-170 ç§’ï¼ˆ1.2-2.8 åˆ†é’Ÿï¼‰
èŠ‚çœ:           10-45 ç§’
```

#### æ–¹æ¡ˆ 2ï¼šä½¿ç”¨è‡ªæ‰˜ç®¡è¿è¡Œå™¨
```
setup-java:     10-20 ç§’ï¼ˆå‡å°‘ 25-85 ç§’ï¼‰
setup-flutter:  15-30 ç§’ï¼ˆå‡å°‘ 30-80 ç§’ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡:           25-50 ç§’ï¼ˆ0.4-0.8 åˆ†é’Ÿï¼‰
èŠ‚çœ:           55-165 ç§’ï¼ˆçº¦ 1-2.8 åˆ†é’Ÿï¼‰
```

---

## ğŸ¯ æ¨èä¼˜åŒ–æ–¹æ¡ˆ

### ä¼˜å…ˆçº§ 1ï¼šç«‹å³å®æ–½ âš ï¸

1. **ä¼˜åŒ– Gradle ç¼“å­˜**
   - å¦‚æœ Gradle ç¼“å­˜ä¸Šä¼ æ—¶é—´ > 2 åˆ†é’Ÿï¼Œæ”¹ä¸ºæ‰‹åŠ¨ç¼“å­˜
   - åªç¼“å­˜å¿…è¦çš„ç›®å½•

2. **æ£€æŸ¥ç¼“å­˜å‘½ä¸­ç‡**
   - ç›‘æ§ç¼“å­˜æ¢å¤æ—¶é—´
   - å¦‚æœç¼“å­˜å‘½ä¸­ç‡ < 50%ï¼Œæ£€æŸ¥ç¼“å­˜é”®ç­–ç•¥

### ä¼˜å…ˆçº§ 2ï¼šè¯„ä¼°åå†³å®š ğŸ’¡

3. **è€ƒè™‘è‡ªæ‰˜ç®¡è¿è¡Œå™¨**
   - å¦‚æœæ„å»ºé¢‘ç‡é«˜ï¼ˆæ¯å¤© > 10 æ¬¡ï¼‰
   - å¦‚æœæ€»æ„å»ºæ—¶é—´ > 30 åˆ†é’Ÿ

4. **ä¼˜åŒ– Flutter SDK ä¸‹è½½**
   - æ£€æŸ¥æ˜¯å¦æœ‰åŠæ³•ç¼“å­˜ Flutter SDK
   - è€ƒè™‘ä½¿ç”¨é¢„æ„å»ºçš„ Flutter é•œåƒ

### ä¼˜å…ˆçº§ 3ï¼šé•¿æœŸä¼˜åŒ– ğŸ“Š

5. **ç›‘æ§å’Œåˆ†æ**
   - è®°å½•æ¯æ¬¡æ„å»ºçš„è€—æ—¶
   - è¯†åˆ«ç“¶é¢ˆæ­¥éª¤
   - æŒç»­ä¼˜åŒ–

---

## ğŸ“ å®æ–½æ£€æŸ¥æ¸…å•

- [ ] ç›‘æ§å½“å‰ setup-java è€—æ—¶
- [ ] ç›‘æ§å½“å‰ setup-flutter è€—æ—¶
- [ ] æ£€æŸ¥ Gradle ç¼“å­˜å¤§å°å’Œä¸Šä¼ æ—¶é—´
- [ ] å¦‚æœ Gradle ç¼“å­˜ä¸Šä¼  > 2 åˆ†é’Ÿï¼Œå®æ–½æ‰‹åŠ¨ç¼“å­˜
- [ ] ç›‘æ§ç¼“å­˜å‘½ä¸­ç‡
- [ ] è¯„ä¼°æ˜¯å¦éœ€è¦è‡ªæ‰˜ç®¡è¿è¡Œå™¨
- [ ] è®°å½•ä¼˜åŒ–å‰åçš„è€—æ—¶å¯¹æ¯”

---

## ğŸ”— å‚è€ƒèµ„æº

- [GitHub Actions ç¼“å­˜æœ€ä½³å®è·µ](https://docs.github.com/en/actions/using-workflows/caching-dependencies-to-speed-up-workflows)
- [setup-java Action æ–‡æ¡£](https://github.com/actions/setup-java)
- [Flutter Action æ–‡æ¡£](https://github.com/subosito/flutter-action)
- [GitHub Actions æ€§èƒ½ä¼˜åŒ–](https://docs.github.com/en/actions/learn-github-actions/workflow-syntax-for-github-actions)

